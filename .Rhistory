dplyr::mutate(cat = trimws(cat)) %>%
dplyr::filter(cat != "") %>%
stats::na.omit()
# --- Handle variants via helpers ---
if (variant == "FN") {
dat <- xd_index_normalised(dat)
} else if (variant == "f") {
dat <- xd_index_fractional(dat)
}
# --- Create sparse matrix ---
unique_categories <- unique(dat$cat)
unique_ids <- unique(dat$id)
citation_matrix <- Matrix::sparseMatrix(
i = match(dat$id, unique_ids),
j = match(dat$cat, unique_categories),
x = dat$cit,
dims = c(length(unique_ids), length(unique_categories)),
dimnames = list(unique_ids, unique_categories)
)
# --- Aggregate category strengths ---
col_sum_citation_matrix <- Matrix::colSums(citation_matrix)
# --- Compute xd-index ---
if (type == "h") {
xd_val <- agop::index.h(unname(col_sum_citation_matrix))
} else if (type == "g") {
xd_val <- agop::index.g(unname(col_sum_citation_matrix))
} else {
stop("Invalid type. Use 'h' or 'g'.")
}
# get keywords whose citation counts meet the index threshold
core_keywords <- names(col_sum_citation_matrix)[col_sum_citation_matrix >= xd_val]
# --- Plot (optional) ---
if (plot) {
df_plot <- data.frame(cat = names(col_sum_citation_matrix),
cit = col_sum_citation_matrix) %>%
dplyr::arrange(dplyr::desc(cit)) %>%
dplyr::mutate(cat = factor(cat, levels = cat))
print(
ggplot2::ggplot(df_plot) +
ggplot2::geom_point(ggplot2::aes(x = cat, y = cit), shape = 16) +
ggplot2::geom_segment(x = xd_val,
xend = xd_val,
y = -Inf,
yend = Inf,
color = "#ff0000",
linetype = 2) +
ggplot2::xlab("Categories") +
ggplot2::ylab("Total Strength") +
ggplot2::ggtitle(label = paste("xd-index (variant:", variant, ")")) +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 90, hjust = 1, vjust = 0.5))
)
}
return(list(xd.index = xd_val,
xd.keywords = core_keywords))
}
xd_index(df = dat, cat = "categories", id = "id", cit = "citations", variant = "full", plot = TRUE)
xd_index(df = dat, cat = "categories", id = "id", cit = "citations", variant = "f", plot = TRUE)
#### Main function ---
xd_index <- function(df,
cat,
id,
cit,
type = "h",
dlm = ";",
variant = "full",
plot = FALSE) {
# --- Package checks ---
for (pkg in c("Matrix","agop","tidyr","ggplot2","dplyr","stats")) {
if (!requireNamespace(pkg, quietly = TRUE)) {
stop("Package '", pkg, "' is required but not installed.")
}
}
# --- Helper: fractional variant ---
xd_index_fractional <- function(dat) {
dat$cit <- dat$cit / dat$inst_count
return(dat)
}
# --- Helper: field-normalized variant ---
xd_index_normalised <- function(dat) {
if (!"mfc" %in% colnames(dat)) {
message("'mfc' not provided. Computing category means from provided data.")
dat <- dat %>%
dplyr::group_by(cat) %>%
dplyr::mutate(mfc = mean(cit, na.rm = TRUE)) %>%
dplyr::ungroup()
}
if (any(is.na(dat$mfc))) {
message("Found missing mean citations for some categories. Excluding these publications.")
dat <- dat[!is.na(dat$mfc), ]
}
dat <- dat %>% dplyr::mutate(cit = cit / mfc)
return(dat)
}
# --- Working data frame ---
dat <- df %>%
dplyr::select(cat = {{cat}},
id = {{id}},
cit = {{cit}},
dplyr::everything()) %>%
dplyr::mutate(cat = as.character(cat),
id = as.character(id),
cit = as.numeric(cit)) %>%
stats::na.omit()
# check for institution count column in df
if (variant == "f") {
# If inst_count not provided, build it
if (!"inst_count" %in% colnames(dat)) {
stop("Institution counts per 'inst_count' not provided.")
}
}
# Split multiple categories
dat <- dat %>%
tidyr::separate_rows(cat, sep = dlm) %>%
dplyr::mutate(cat = trimws(cat)) %>%
dplyr::filter(cat != "") %>%
stats::na.omit()
# --- Handle variants via helpers ---
if (variant == "FN") {
dat <- xd_index_normalised(dat)
} else if (variant == "f") {
dat <- xd_index_fractional(dat)
}
# --- Create sparse matrix ---
unique_categories <- unique(dat$cat)
unique_ids <- unique(dat$id)
citation_matrix <- Matrix::sparseMatrix(
i = match(dat$id, unique_ids),
j = match(dat$cat, unique_categories),
x = dat$cit,
dims = c(length(unique_ids), length(unique_categories)),
dimnames = list(unique_ids, unique_categories)
)
# --- Aggregate category strengths ---
col_sum_citation_matrix <- Matrix::colSums(citation_matrix)
# --- Compute xd-index ---
if (type == "h") {
xd_val <- agop::index.h(unname(col_sum_citation_matrix))
} else if (type == "g") {
xd_val <- agop::index.g(unname(col_sum_citation_matrix))
} else {
stop("Invalid type. Use 'h' or 'g'.")
}
# get keywords whose citation counts meet the index threshold
core_keywords <- names(col_sum_citation_matrix)[col_sum_citation_matrix >= xd_val]
# --- Plot (optional) ---
if (plot) {
df_plot <- data.frame(cat = names(col_sum_citation_matrix),
cit = col_sum_citation_matrix) %>%
dplyr::arrange(dplyr::desc(cit)) %>%
dplyr::mutate(cat = factor(cat, levels = cat))
print(
ggplot2::ggplot(df_plot) +
ggplot2::geom_point(ggplot2::aes(x = cat, y = cit), shape = 16) +
ggplot2::geom_segment(x = xd_val,
xend = xd_val,
y = -Inf,
yend = Inf,
color = "#ff0000",
linetype = 2) +
ggplot2::xlab("Categories") +
ggplot2::ylab("Total Strength") +
ggplot2::ggtitle(label = paste("xd-index (variant:", variant, ")")) +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 90, hjust = 1, vjust = 0.5))
)
}
return(list(xd.index = xd_val,
xd.keywords = core_keywords))
}
xd_index(df = dat, cat = "categories", id = "id", cit = "citations", variant = "f", plot = TRUE)
xd_index(df = dat, cat = "categories", id = "id", cit = "citations", variant = "full", plot = TRUE)
xd_index(df = dat, cat = "categories", id = "id", cit = "citations", variant = "FN", plot = TRUE)
xd_index(df = dat, cat = "categories",  cit = "citations", variant = "FN", plot = TRUE)
xd_index(df = dat, cat = "categories", cit = "citations", variant = "FN", plot = TRUE)
dat <- data.frame(uid = c("abc123", "bcd234", "def345", "efg456", "fgh567", "ghi678", "hij789"),
categories = c("a; d; e", "b", "c", "d; g", "e", "f", "g"),
keywords = c("a; b; c", "b; d", "c", "d", "e; g", "f", "g"),
citations = c(10, 5, 8, 4, 23, 12, 6),
inst_count = c(2, 1, 3, 3, 2, 3, 1),
mfc = c(3.2, 1.7, 3.5, 1.8, 3.4, 2.4, 1.1))
xd_index(df = dat, cat = "categories", cit = "citations", variant = "FN", plot = TRUE)
dat <- data.frame(id = c("abc123", "bcd234", "def345", "efg456", "fgh567", "ghi678", "hij789"),
categories = c("a; d; e", "b", "c", "d; g", "e", "f", "g"),
keywords = c("a; b; c", "b; d", "c", "d", "e; g", "f", "g"),
citations = c(10, 5, 8, 4, 23, 12, 6),
inst_count = c(2, 1, 3, 3, 2, 3, 1),
mfc = c(3.2, 1.7, 3.5, 1.8, 3.4, 2.4, 1.1))
xc_index(df = dat, kw = "keywords", cat = "categories", id = "id", cit = "citations", plot = TRUE)
#### Main function ---
xd_index <- function(df,
cat,
id,
cit,
type = "h",
dlm = ";",
variant = "full",
plot = FALSE) {
# --- Package checks ---
for (pkg in c("Matrix","agop","tidyr","ggplot2","dplyr","stats")) {
if (!requireNamespace(pkg, quietly = TRUE)) {
stop("Package '", pkg, "' is required but not installed.")
}
}
# --- Helper: fractional variant ---
xd_index_fractional <- function(dat) {
dat$cit <- dat$cit / dat$inst_count
return(dat)
}
# --- Helper: field-normalized variant ---
xd_index_normalised <- function(dat) {
if (!"mfc" %in% colnames(dat)) {
message("'mfc' not provided. Computing category means from provided data.")
dat <- dat %>%
dplyr::group_by(cat) %>%
dplyr::mutate(mfc = mean(cit, na.rm = TRUE)) %>%
dplyr::ungroup()
}
if (any(is.na(dat$mfc))) {
message("Found missing mean citations for some categories. Excluding these publications.")
dat <- dat[!is.na(dat$mfc), ]
}
dat <- dat %>% dplyr::mutate(cit = cit / mfc)
return(dat)
}
# --- Working data frame ---
dat <- df %>%
dplyr::select(cat = {{cat}},
id = {{id}},
cit = {{cit}},
dplyr::everything()) %>%
dplyr::mutate(cat = as.character(cat),
id = as.character(id),
cit = as.numeric(cit)) %>%
stats::na.omit()
# check for institution count column in df
if (variant == "f") {
# If inst_count not provided, build it
if (!"inst_count" %in% colnames(dat)) {
stop("Institution counts per 'inst_count' not provided.")
}
}
# Split multiple categories
dat <- dat %>%
tidyr::separate_rows(cat, sep = dlm) %>%
dplyr::mutate(cat = trimws(cat)) %>%
dplyr::filter(cat != "") %>%
stats::na.omit()
# --- Handle variants via helpers ---
if (variant == "FN") {
dat <- xd_index_normalised(dat)
} else if (variant == "f") {
dat <- xd_index_fractional(dat)
}
# --- Create sparse matrix ---
unique_categories <- unique(dat$cat)
unique_ids <- unique(dat$id)
citation_matrix <- Matrix::sparseMatrix(
i = match(dat$id, unique_ids),
j = match(dat$cat, unique_categories),
x = dat$cit,
dims = c(length(unique_ids), length(unique_categories)),
dimnames = list(unique_ids, unique_categories)
)
# --- Aggregate category strengths ---
col_sum_citation_matrix <- Matrix::colSums(citation_matrix)
# --- Compute xd-index ---
if (type == "h") {
xd_val <- agop::index.h(unname(col_sum_citation_matrix))
} else if (type == "g") {
xd_val <- agop::index.g(unname(col_sum_citation_matrix))
} else {
stop("Invalid type. Use 'h' or 'g'.")
}
# get keywords whose citation counts meet the index threshold
core_keywords <- names(col_sum_citation_matrix)[col_sum_citation_matrix >= xd_val]
# --- Plot (optional) ---
if (plot) {
df_plot <- data.frame(cat = names(col_sum_citation_matrix),
cit = col_sum_citation_matrix) %>%
dplyr::arrange(dplyr::desc(cit)) %>%
dplyr::mutate(cat = factor(cat, levels = cat))
print(
ggplot2::ggplot(df_plot) +
ggplot2::geom_point(ggplot2::aes(x = cat, y = cit), shape = 16) +
ggplot2::geom_segment(x = xd_val,
xend = xd_val,
y = -Inf,
yend = Inf,
color = "#ff0000",
linetype = 2) +
ggplot2::xlab("Categories") +
ggplot2::ylab(ifelse(variant == "f",
"Total Fractional Citations",
ifelse(variant == "FN", "Total Field-Normalised Citations", "Total Citations"))) +
ggplot2::ggtitle(label = paste("xd-index (variant:", variant, ")")) +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 90, hjust = 1, vjust = 0.5))
)
}
return(list(xd.index = xd_val,
xd.keywords = core_keywords))
}
xd_index(df = dat, cat = "categories", id = "id", cit = "citations", variant = "FN", plot = TRUE)
xd_index(df = dat, cat = "categories", id = "id", cit = "citations", variant = "f", plot = TRUE)
################################################################################
dat1 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (1).xls")
dat2 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (2).xls")
dat3 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (3).xls")
dat_merged <- rbind(dat1, dat2)
dat_merged <- rbind(dat_merged, dat3)
summary(dat_merged$Affiliations)
dat_merged <- dat_merged %>%
dplyr::select(`UT (Unique QOS ID)`,
`Keywords Plus`,
`WoS Categories`,
`Times Cited, WoS Core`)
dat_merged <- dat_merged %>%
dplyr::select(`UT (Unique WOS ID)`,
`Keywords Plus`,
`WoS Categories`,
`Times Cited, WoS Core`)
View(dat_merged)
xd_index(df = dat_merged,
cat = "WoS Categories",
id = "UT (Unique WOS ID)",
cit = "Times Cited, WoS Core",
variant = "full",
plot = TRUE)
################################################################################
WoSdata <- dat_merged
usethis::use_data(WoSdata)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
?WoSdata
??WoSdata
devtools::load_all()
?WoSdata
devtools::document()
?WoSdata
devtools::document()
?WoSdata
devtools::document()
?WoSdata
devtools::check()
devtools::load_all()
################################################################################
WoSdata
################################################################################
data(WoSdata)
head(Wosdata)
head(WoSdata)
################################################################################
data("WoSdata")
devtools::document()
devtools::check()
################################################################################
data("WoSdata")
names(WoSdata)
devtools::document()
devtools::check()
dat1 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (1).xls")
dat2 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (2).xls")
dat3 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (3).xls")
dat_merged <- rbind(dat1, dat2)
dat_merged <- rbind(dat_merged, dat3)
dat_merged <- dat_merged %>%
dplyr::select(`UT (Unique WOS ID)`,
`Keywords Plus`,
`WoS Categories`,
`Times Cited, WoS Core`) %>%
dplyr::rename(UT.Unique.WOS.ID = `UT (Unique WOS ID)`,
Keywords.Plus = `Keywords Plus`,
WoS.Categories = `WoS Categories`,
Times.Cited.WoS.Core = `Times Cited, WoS Core`)
usethis::use_data(WoSdata, overwrite = TRUE)
devtools::document()
devtools::check()
data(WoSdata)
dat1 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (1).xls")
dat2 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (2).xls")
dat3 <- readxl::read_xls("../ALAGAPPA UNIVERSITY (3).xls")
dat_merged <- rbind(dat1, dat2)
dat_merged <- rbind(dat_merged, dat3)
dat_merged <- dat_merged %>%
dplyr::select(`UT (Unique WOS ID)`,
`Keywords Plus`,
`WoS Categories`,
`Times Cited, WoS Core`) %>%
dplyr::rename(UT.Unique.WOS.ID = `UT (Unique WOS ID)`,
Keywords.Plus = `Keywords Plus`,
WoS.Categories = `WoS Categories`,
Times.Cited.WoS.Core = `Times Cited, WoS Core`)
WoSdata <- dat_merged
usethis::use_data(WoSdata, overwrite = TRUE)
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
WoSdata$inst_count <- runif(n = 2355, min = 1, max = 10)
devtools::document()
devtools::document()
devtools::load_all()
################################################################################
data(WoSdata)
head(WoSdata)
################################################################################
# test
x_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
kw = "Keywords.Plus",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
xc_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
kw = "Keywords.Plus",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
variant = "FN",
plot = TRUE)
devtools::document()
devtools::load_all()
xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
variant = "FN",
plot = TRUE)
ivw_xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
devtools::document()
devtools::load_all()
ivw_xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
set.seed(123)
WoSdata$inst_count <- runif(n = 2355, min = 1, max = 10)
xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
variant = "f",
plot = TRUE)
devtools::document()
xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
variant = "f",
plot = TRUE)
citation("agop")
citation("bibliometrix")
install.packages("bibliometrix")
citation("bibliometrix")
################################################################################
data(WoSdata)
head(WoSdata)
################################################################################
# test
x_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
kw = "Keywords.Plus",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
xc_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
kw = "Keywords.Plus",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
set.seed(123)
WoSdata$inst_count <- runif(n = 2355, min = 1, max = 10)
xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
variant = "f",
plot = TRUE)
xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
variant = "FN",
plot = TRUE)
ivw_xd_index(df = WoSdata,
id = "UT.Unique.WOS.ID",
cat = "WoS.Categories",
cit = "Times.Cited.WoS.Core",
plot = TRUE)
devtools::document()
devtools::document()
